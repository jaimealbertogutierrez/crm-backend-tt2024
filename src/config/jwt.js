/*******************************************************************
 ********************************************************************
 ********************************************************************
 PROYECTO FINAL DE DESARROLLO WEB AVANZADO
 PROGRAMA TALENTO TECH
 MINISTERIO DE TECNOLOGÍAS DE INFORMACIÓN Y LAS COMUNICACIONES

 ELABORO:  ING. JAIME ALBERTO GUTIÉRREZ MEJÍA
 CC.  9733675 DE ARMENIA, QUINDÍO
 ANALISTA PROGRAMADOR JAVA Y NODEJS

 Nombre componente: jwt.js
 Objetivo: Configura y exporta la funcionalidad de generación y verificación de tokens JWT para la autenticación de usuarios.
 Total de métodos: 2

 Fecha de elaboración: Octubre 2024

 MINTIC
 TALENTO TECH
 TODOS LOS DERECHOS RESERVADOS
 JAIME ALBERTO GUTIÉRREZ
 2024
 ********************************************************************
 ********************************************************************
 *******************************************************************/
//*********************************************************************
//*********************************************************************
//*********************************************************************
// src/utils/jwt.js
const jwt = require('jsonwebtoken');
require('dotenv').config();

//*********************************************************************
//*********************************************************************
//*********************************************************************
const generateToken = (user) => {
    return jwt.sign(
        { id: user.usuario_id, role: user.rol },
        process.env.JWT_SECRET,
        { expiresIn: '1h' }
    );
};

//*********************************************************************
//*********************************************************************
//*********************************************************************
const verifyToken = (token) => {
    return jwt.verify(token, process.env.JWT_SECRET);
};

module.exports = { generateToken, verifyToken };

//*********************************************************************
//*********************************************************************
//*********************************************************************
//*********************************************************************
//*********************************************************************
//*********************************************************************
